"use strict";angular.module("myApp",["ngRoute","myApp.input","ui.bootstrap"]).config(["$routeProvider",function($routeProvider){$routeProvider.when("/grad-cost",{templateUrl:"input/input.html",controller:"InputController"});$routeProvider.otherwise({redirectTo:"/grad-cost"})}]);"use strict";var inputModule=angular.module("myApp.input",["ngRoute"]);inputModule.controller("InputController",["$scope","$filter","schoolsInfo",function($scope,$filter,schoolsInfo){$scope.hideCosts=true;$scope.hidePayments=true;$scope.hideLoans=true;$scope.hideDebt=true;$scope.hideDisclaimer=true;$scope.hideAbout=true;$scope.hideContact=true;var em1="ett.dev";var em2="eloper@g";var em3="mail.com";$scope.em=em1+em2+em3;$scope.schools=schoolsInfo.allSchools();var defaultCosts={};$scope.costs=angular.copy(defaultCosts);$scope.payments={scholarships:0,assistanceships:0,jobs:0,savings:0};$scope.data={years:2};$scope.updateSchool=function(){$scope.costNotes=null;if($scope.school){$scope.programs=schoolsInfo.allPrograms($scope.school);if(schoolsInfo.schoolCosts($scope.school)){$scope.costs=angular.copy(schoolsInfo.schoolCosts($scope.school));$scope.update()}}else{$scope.programs=[];$scope.costs=angular.copy(defaultCosts);$scope.update();$scope.hideCosts=false}};$scope.updateProgram=function(){$scope.costNotes=null;if($scope.school&&$scope.program){var program=schoolsInfo.programInfo($scope.school,$scope.program);if(program.costs){angular.extend($scope.costs,program.costs)}if(program.years){$scope.data.years=program.years}if(program.notes){$scope.costNotes=program.notes}}else{$scope.hideCosts=false;if(schoolsInfo.schoolCosts($scope.school)){$scope.costs=angular.copy(schoolsInfo.schoolCosts($scope.school))}else{$scope.costs=angular.copy(defaultCosts)}}$scope.update()};$scope.repayment={standard:{},extended:{},graduated10:{},graduated25:{}};$scope.stafford={origination:.01068,interest:.0584,yearlyMax:20500};$scope.plus={origination:.04272,interest:.0684};var sum=function(obj){var total=0;for(var el in obj){if(obj.hasOwnProperty(el)&&!isNaN(parseFloat(obj[el]))){total+=parseFloat(obj[el])}}return total};var compounded=function(p,i,t){return Math.pow(1+i,t)*p};var accumulatedDebt=function(amount,origination,interest,time){return compounded(amount*(1+origination),interest,time)};var singleYearLoanDebt=function(loanObj,time){return accumulatedDebt(loanObj.yearlyAmount,loanObj.origination,loanObj.interest,time)};var multiYearLoanDebt=function(loanObj,numYears){if(numYears==1){return singleYearLoanDebt(loanObj,1)}else{return singleYearLoanDebt(loanObj,numYears)+multiYearLoanDebt(loanObj,numYears-1)}};var aArgs=function(){return{principal:[$scope.stafford.gradDebt,$scope.plus.gradDebt],interestRate:[$scope.stafford.interest*100,$scope.plus.interest*100],monthsInRepayment:0}};var monthlyPayment=function(paymentPlan,aArgs,sType){return REPAYMENT[paymentPlan](aArgs,sType)};$scope.update=function(){$scope.totalCosts=sum($scope.costs);$scope.totalPayments=sum($scope.payments);$scope.totalLoans=$scope.totalCosts-$scope.totalPayments;if($scope.totalLoans<$scope.stafford.yearlyMax){$scope.stafford.yearlyAmount=$scope.totalLoans;$scope.plus.yearlyAmount=0}else{$scope.stafford.yearlyAmount=$scope.stafford.yearlyMax;$scope.plus.yearlyAmount=$scope.totalLoans-$scope.stafford.yearlyMax}$scope.stafford.gradDebt=multiYearLoanDebt($scope.stafford,$scope.data.years);$scope.plus.gradDebt=multiYearLoanDebt($scope.plus,$scope.data.years);$scope.data.gradDebt=$scope.stafford.gradDebt+$scope.plus.gradDebt;$scope.repayment.standard.monthly=monthlyPayment("standardRepayment",aArgs(),"standard");$scope.repayment.standard.total=$scope.repayment.standard.monthly*120;$scope.repayment.standard.interest=$scope.repayment.standard.total-$scope.data.gradDebt;$scope.repayment.extended.monthly=parseFloat(monthlyPayment("standardRepayment",aArgs(),"extended"))||0;$scope.repayment.extended.total=$scope.repayment.extended.monthly*300;$scope.repayment.extended.interest=$scope.repayment.extended.total-$scope.data.gradDebt;$scope.repayment.graduated10.firstMonthly=monthlyPayment("graduatedRepayment",aArgs(),"standard");$scope.repayment.graduated10.lastMonthly=3*$scope.repayment.graduated10.firstMonthly;$scope.repayment.graduated10.averageMonthly=($scope.repayment.graduated10.firstMonthly+$scope.repayment.graduated10.lastMonthly)/2;$scope.repayment.graduated10.total=$scope.repayment.graduated10.averageMonthly*120;$scope.repayment.graduated10.interest=$scope.repayment.graduated10.total-$scope.data.gradDebt;$scope.repayment.graduated25.firstMonthly=parseFloat(monthlyPayment("graduatedRepayment",aArgs(),"extended"))||0;$scope.repayment.graduated25.lastMonthly=3*$scope.repayment.graduated25.firstMonthly;$scope.repayment.graduated25.averageMonthly=($scope.repayment.graduated25.firstMonthly+$scope.repayment.graduated25.lastMonthly)/2;$scope.repayment.graduated25.total=$scope.repayment.graduated25.averageMonthly*300;$scope.repayment.graduated25.interest=$scope.repayment.graduated25.total-$scope.data.gradDebt};$scope.update()}]);inputModule.factory("schoolsInfo",function(){var programDetails={Harvard:{costs:{housing:11770,insurance:1042+2390,personal:14318},programs:{MBA:{notes:"Costs are for 9 month academic year. Fees include books. Personal costs include food.",years:2,costs:{fees:7655,tuition:61225}}}},"UC Berkeley":{costs:{housing:12618,food:7138,insurance:3754,books:796,personal:1548,transportation:3020},programs:{"MS, Non-professional":{years:2,costs:{tuition:13432+15102,fees:0}},"MS, Non-professional (in state)":{years:2,costs:{tuition:13432,fees:0}}}},"University of Pennsylvania":{costs:{housing:14400,food:6e3,personal:3600,transportation:240,insurance:3300},programs:{MD:{notes:"Based on second year costs. Does not include USMLE expenses.",years:4,costs:{tuition:52210,fees:2686+1326+514+48,books:550,transportation:240+200}}}},Widener:{costs:{fees:248+50,housing:8190,food:1328*2,books:1200,personal:1188,transportation:2700},programs:{"PSY D":{years:5,costs:{tuition:29468}}}}};var schoolsInfoObject={allSchools:function(){return Object.keys(programDetails)},schoolCosts:function(schoolName){return programDetails[schoolName]["costs"]},allPrograms:function(schoolName){return Object.keys(programDetails[schoolName]["programs"])},programInfo:function(schoolName,programName){return programDetails[schoolName]["programs"][programName]}};return schoolsInfoObject});inputModule.filter("toCurrency",function($filter){return function(num){return $filter("currency")(num,"$",0)}});inputModule.filter("toPercent",function($filter){return function(num){return $filter("number")(num*100,2)+"%"}});inputModule.directive("format",["$filter",function($filter){return{require:"?ngModel",link:function(scope,elem,attrs,ctrl){if(!ctrl)return;ctrl.$formatters.unshift(function(a){return $filter(attrs.format)(ctrl.$modelValue)});ctrl.$parsers.unshift(function(viewValue){var cursorPointer=elem[0].selectionStart;var elemLength=elem[0].value.length;var plainNumber=viewValue.replace(/[^\d|\-+|\.+]/g,"");elem.val($filter("number")(plainNumber));if(cursorPointer!=elemLength){elem[0].setSelectionRange(cursorPointer,cursorPointer)}return plainNumber})}}}]);var REPAYMENT=function(){var a=function(b,c){switch(c){case"AK":return 14720+5200*(b-1);break;case"HI":return 13550+4780*(b-1);break;default:return 11770+4160*(b-1)}};return{standardRepayment:function(f,g){var d=0,b=0;for(var c=0;c<f.principal.length;c++){iTerm=(g.toLowerCase()==="extended"?300:120)-f.monthsInRepayment;if(iTerm<1){iTerm=1}d+=iPrincipal=f.principal[c];iInterestRate=f.interestRate[c]/100;iOutstandingInterest=iPrincipal*(iInterestRate/12);var e=iPrincipal/(1/(1+iOutstandingInterest/iPrincipal)*(1-1/Math.pow(1+iInterestRate/12,iTerm))/(1-1/(1+iInterestRate/12)));if(isNaN(e)){b+=0}else{b+=e}}if(g.toLowerCase()==="extended"&&d<3e4){return"Not Qualified"}if(b<50){b=50}if(d==0){b=0}return b},oldGraduatedRepayment:function(d,b){var g=24,m=0,h=0;if(b.toLowerCase()==="extended"){var k=.05,l=12}else{var k=.2,l=5}for(var f=0;f<d.principal.length;f++){h+=iPrincipal=d.principal[f];iInterestRate=d.interestRate[f]/100;iOutstandingInterest=iPrincipal*(iInterestRate/12);iBasicRatio=1/(1+iInterestRate/12);iGeometricProgressionTotal=0;iFirstTermGeo=1/(1+iOutstandingInterest/iPrincipal);for(var e=0;e<l;e++){iGeometricProgressionTotal+=iFirstTermGeo*(1-Math.pow(iBasicRatio,g))/(1-iBasicRatio);iFirstTermGeo=iFirstTermGeo*Math.pow(iBasicRatio,g)*(1+k)}var c=iPrincipal/iGeometricProgressionTotal;if(isNaN(c)){m+=0}else{m+=c}}if(b.toLowerCase()==="extended"&&h<3e4){return"Not Qualified"}return m},graduatedRepayment:function(c,g){if(g=="extended"){var e=0;for(var s=0;s<c.principal.length;s++){e+=c.principal[s]}if(e<3e4){return"Not Qualified"}}var m=0,w=g=="extended"?12:5;for(var q=0;q<c.principal.length;q++){var k=new Array;k.principal=c.principal[q],k.interestRate=c.interestRate[q];var f=c.principal[q],v=0,x=c.interestRate[q]/100,n=x/12,o=0,l=1.2437673130193905,u=Math.max(5,REPAYMENT.standardRepayment(k,"standard")/2,f*n);firstPayment=u,secondPayment=firstPayment*l,thirdPayment=secondPayment*l,fourthPayment=thirdPayment*l,fifthPayment=fourthPayment*l,incrementFactor=0,prevIncrementFactor=0,threeTimesPayment=u*3,amountChange=fifthPayment,lastGradPaymentAmount=fifthPayment,populateLevels=function(){var i=new Array(firstPayment,secondPayment,thirdPayment,fourthPayment,fifthPayment);return i},s=1;while(s<99){var d=populateLevels();v=f;for(var r=0;r<w;r++){var t=1;while(t<=24){o=n*v;v=v+o-d[r];t+=1}}if(parseInt(v)<=5&&parseInt(v)>=-5){break}if(parseInt(v)>5){incrementFactor=1}else{if(parseInt(v)<-5){incrementFactor=-1}}if(incrementFactor>0&&prevIncrementFactor>0||incrementFactor<0&&prevIncrementFactor<0){}else{amountChange=amountChange/2}prevIncrementFactor=incrementFactor;lastGradPaymentAmount=lastGradPaymentAmount+amountChange*incrementFactor;var h=1/4;var b=lastGradPaymentAmount/firstPayment;l=Math.pow(b,h);firstPayment=u*l;secondPayment=firstPayment*l;thirdPayment=secondPayment*l;fourthPayment=thirdPayment*l;fifthPayment=fourthPayment*l;threeTimesPayment=firstPayment*3;if(threeTimesPayment>fifthPayment){u-=1}else{u+=1}s=s+1}m+=firstPayment}return m},payAsYouEarnRepayment:function(d){var b=0,c=a(d.familySize?d.familySize:1,d.state?d.state:"PA");b=(d.AGI-1.5*c)*.1/12;if(b>REPAYMENT.standardRepayment(d,"standard")){return"Not Qualified"}else{if(b<0){b=0}}return b},incomeBasedRepayment:function(d){var b=0,c=a(d.familySize?d.familySize:1,d.state?d.state:"PA");b=(d.AGI-1.5*c)*.15/12;if(b>REPAYMENT.standardRepayment(d,"standard")){return"Not Qualified"}else{if(b<0){b=0}}return b},incomeContingentRepayment:function(c){iPrincipalConstantMultiplier=0;for(var b=0;b<c.principal.length;b++){switch(true){case c.interestRate[b]<=3.5:iConstantMultiplier=.102174;break;case c.interestRate[b]<=4:iConstantMultiplier=.105063;break;case c.interestRate[b]<=4.5:iConstantMultiplier=.108001;break;case c.interestRate[b]<=5:iConstantMultiplier=.110987;break;case c.interestRate[b]<=5.5:iConstantMultiplier=.114021;break;case c.interestRate[b]<=6:iConstantMultiplier=.117102;break;case c.interestRate[b]<=6.8:iConstantMultiplier=.12213;break;case c.interestRate[b]<=7:iConstantMultiplier=.123406;break;case c.interestRate[b]<=7.9:iConstantMultiplier=.129237;break;case c.interestRate[b]<=8:iConstantMultiplier=.129894;break;default:iConstantMultiplier=.131545;break}iPrincipalConstantMultiplier+=c.principal[b]*iConstantMultiplier}if(c.familySize>1){switch(true){case c.AGI<=11150:iIPF=50.52;break;case c.AGI<=17593:iIPF=56.68;break;case c.AGI<=20965:iIPF=59.56;break;case c.AGI<=27408:iIPF=67.79;break;case c.AGI<=33954:iIPF=75.22;break;case c.AGI<=42648:iIPF=87.61;break;case c.AGI<=53487:iIPF=100;break;case c.AGI<=64331:iIPF=100;break;case c.AGI<=80596:iIPF=109.4;break;case c.AGI<=107695:iIPF=125;break;case c.AGI<=145638:iIPF=140.6;break;case c.AGI<=203682:iIPF=150;break;default:iIPF=200;break}}else{switch(true){case c.AGI<=11150:iIPF=55;break;case c.AGI<=15342:iIPF=57.79;break;case c.AGI<=19741:iIPF=60.57;break;case c.AGI<=24240:iIPF=66.23;break;case c.AGI<=28537:iIPF=71.89;break;case c.AGI<=33954:iIPF=80.33;break;case c.AGI<=42648:iIPF=88.77;break;case c.AGI<=53488:iIPF=100;break;case c.AGI<=64331:iIPF=100;break;case c.AGI<=77318:iIPF=111.8;break;case c.AGI<=99003:iIPF=123.5;break;case c.AGI<=140221:iIPF=141.2;break;case c.AGI<=160776:iIPF=150;break;default:iIPF=200;break}}iMonthlyPaymentA=iPrincipalConstantMultiplier*iIPF/100/12;iPoverty=a(c.familySize?c.familySize:1,c.state?c.state:"PA");iMonthlyPaymentB=(c.AGI-iPoverty)*.2/12;iMonthlyPayment=Math.min(iMonthlyPaymentA,iMonthlyPaymentB);if(iMonthlyPayment<0){iMonthlyPayment=0}return iMonthlyPayment},incomeSensitiveRepayment:function(c){iMonthlyPayment=0;iMonthlyInterest=0;for(var b=0;b<c.principal.length;b++){iMonthlyPayment+=c.AGI*.04/12;iMonthlyInterest+=c.principal[b]*c.interestRate[b]/100/12}return Math.max(iMonthlyPayment,iMonthlyInterest)}}}();